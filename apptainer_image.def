Bootstrap: docker
From: ubuntu:24.04

%post
    # Prevent interactive prompts (like timezone selection)
    export DEBIAN_FRONTEND=noninteractive

    # 1. Update apt and install dependencies
    apt-get update 
    apt-get install -y curl ca-certificates nodejs npm
    apt-get install -y zlib1g-dev
    apt-get install -y nvtop
    
    # we need the following for web-gpu passthrough
    apt-get install -y libvulkan1 mesa-vulkan-drivers vulkan-tools libgl1 libegl1

    # 2. Install uv
    # Download the installer and pipe to sh
    curl -LsSf https://astral.sh/uv/install.sh | sh

    # Move binaries to global path
    mv /root/.local/bin/uv /usr/local/bin/uv
    mv /root/.local/bin/uvx /usr/local/bin/uvx

    # 3. Install splat-transform
    npm install -g @playcanvas/splat-transform

    # 4. Cleanup to reduce image size
    apt-get clean
    rm -rf /var/lib/apt/lists/*
    rm -rf /root/.local
    rm -rf /root/.npm
    rm -rf /root/.cache

%environment
    export LC_ALL=C


%labels
    Author User
    Version 1.2
    Base Ubuntu 24.04